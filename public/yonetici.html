<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yönetim Paneli</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        body { background: #f8f9fa; font-family: 'Segoe UI', sans-serif; display: flex; }
        
        .sidebar { width: 260px; height: 100vh; background: #2c3e50; color: white; padding: 20px; position: fixed; display: flex; flex-direction: column; }
        .nav-link { color: #bdc3c7; padding: 12px; margin-bottom: 5px; cursor: pointer; text-decoration: none; border-radius: 8px; }
        .nav-link:hover, .nav-link.active { background: #34495e; color: white; }
        
        .main-content { margin-left: 260px; padding: 30px; width: 100%; }
        
        .tab-section { display: none; }
        .tab-section.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from {opacity:0} to {opacity:1} }
        
        .card-stat { padding: 20px; border-radius: 15px; color: white; position: relative; overflow: hidden; height: 120px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .card-stat h3 { font-size: 1.8rem; font-weight: bold; margin: 0; }
        .card-stat i { position: absolute; right: 20px; bottom: 20px; font-size: 3rem; opacity: 0.2; }
        
        .bg-ciro { background: linear-gradient(45deg, #11998e, #38ef7d); }
        .bg-satis { background: linear-gradient(45deg, #FF416C, #FF4B2B); }
        .bg-randevu { background: linear-gradient(45deg, #2193b0, #6dd5ed); }
        .bg-stok { background: linear-gradient(45deg, #f12711, #f5af19); }
        
        .custom-card { background: white; border-radius: 15px; padding: 20px; border: none; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 20px; }
    </style>
</head>
<body>

    <div class="sidebar">
        <h4 class="mb-4 fw-bold"><i class="fas fa-crown me-2"></i>Livza Yönetim</h4>
        <nav class="nav flex-column">
            <a class="nav-link active" onclick="switchTab('ozet', this)"><i class="fas fa-chart-pie me-2"></i> Genel Özet</a>
            <a class="nav-link" onclick="switchTab('satislar', this)"><i class="fas fa-file-invoice-dollar me-2"></i> Satış Analizi</a>
            <a class="nav-link" onclick="switchTab('randevular', this)"><i class="fas fa-calendar-check me-2"></i> Randevular</a>
            <a class="nav-link" onclick="switchTab('satis-ekle', this)"><i class="fas fa-plus-circle me-2"></i> Satış Gir</a>
            <a class="nav-link" onclick="switchTab('stok', this)"><i class="fas fa-boxes me-2"></i> Stok Takibi</a>
        </nav>
        <div class="mt-auto">
            <a href="/atolye.html" class="nav-link text-warning"><i class="fas fa-cut me-2"></i> Atölye Paneli</a>
            <a href="/index.html" class="nav-link text-danger"><i class="fas fa-sign-out-alt"></i> Çıkış Yap</a>
        </div>
    </div>

    <div class="main-content">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h3 id="page-title" class="fw-bold text-secondary">Genel Özet</h3>
            
        </div>

        <div id="tab-ozet" class="tab-section active">
            <div class="row g-3 mb-4">
                <div class="col-md-3"><div class="card-stat bg-ciro"><p>Toplam Ciro</p><h3 id="stat-ciro">0 ₺</h3><i class="fas fa-wallet"></i></div></div>
                <div class="col-md-3"><div class="card-stat bg-satis"><p>İşlem Adedi</p><h3 id="stat-satis">0</h3><i class="fas fa-shopping-bag"></i></div></div>
                <div class="col-md-3"><div class="card-stat bg-randevu"><p>Randevular</p><h3 id="stat-randevu">0</h3><i class="fas fa-calendar-alt"></i></div></div>
                <div class="col-md-3"><div class="card-stat bg-stok"><p>Kritik Stok</p><h3 id="stat-stok">0</h3><i class="fas fa-exclamation-triangle"></i></div></div>
            </div>
            
            <div class="row g-3 mb-4">
                <div class="col-md-8">
                    <div class="custom-card" style="height: 350px;">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h5 class="text-secondary fw-bold"><i class="fas fa-chart-line me-2"></i>Aylık Ciro</h5>
                            <select id="yilFiltresi" class="form-select form-select-sm w-auto shadow-sm border-0 bg-light fw-bold text-primary" onchange="loadDashboard()">
                                <option value="2025">2025</option>
                            </select>
                        </div>
                        <div style="height: 260px; width: 100%;"><canvas id="incomeChart"></canvas></div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="custom-card" style="height: 350px;">
                        <h5 class="text-secondary fw-bold mb-3"><i class="fas fa-chart-pie me-2"></i>İşlem Dağılımı</h5>
                        <div style="height: 250px; display:flex; justify-content:center"><canvas id="revenueSplitChart"></canvas></div>
                        <div class="text-center mt-2 small text-muted">Satış vs Kiralama Gelir Oranı</div>
                    </div>
                </div>
            </div>
            
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="custom-card" style="height: 400px;">
                        <h5 class="text-secondary fw-bold mb-3"><i class="fas fa-users me-2"></i>Müşteri Mevsimselliği</h5>
                        <div style="height: 300px; width: 100%;"><canvas id="seasonalityChart"></canvas></div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="custom-card" style="height: 400px; overflow-y: auto;">
                        <h5 class="text-secondary fw-bold mb-3">Son İşlemler</h5>
                        <table class="table table-hover align-middle">
                            
                            <tbody id="son-hareketler-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="tab-satislar" class="tab-section">
            <div class="custom-card">
                <table class="table table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Tarih</th>
                            <th>Müşteri</th>
                            <th>Model</th>
                            <th>İşlem</th>
                            <th>Adet</th>
                            <th>Tutar</th>
                            <th>Durum</th> </tr>
                    </thead>
                    <tbody id="satis-listesi-body"></tbody>
                </table>
            </div>
        </div>

        <div id="tab-randevular" class="tab-section">
            <div class="custom-card">
                <table class="table table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Tarih</th>
                            <th>Müşteri</th>
                            <th>Tel</th>
                            <th>Model</th>
                        </tr>
                    </thead>
                    <tbody id="randevu-listesi-body"></tbody>
                </table>
            </div>
        </div>

        <div id="tab-satis-ekle" class="tab-section">
            <div class="custom-card col-md-8 mx-auto">
                <form id="satisForm" onsubmit="satisKaydet(event)">
                    <div class="row mb-3">
                        <div class="col"><label>Müşteri Ad</label><input type="text" id="musteriAd" class="form-control" required></div>
                        <div class="col"><label>Tel</label><input type="text" id="musteriTel" class="form-control"></div>
                    </div>
                    <div class="row mb-3">
                        <div class="col"><label>İşlem</label><select id="islemTuru" class="form-select"><option value="satis">Satış</option><option value="kiralama">Kiralama</option></select></div>
                        <div class="col"><label>Ürün</label><select id="urunSelect" class="form-select" required></select></div>
                    </div>
                    <div class="row mb-3">
                        <div class="col"><label>Adet</label><input type="number" id="adet" class="form-control" value="1"></div>
                        <div class="col"><label>Fiyat</label><input type="number" id="fiyat" class="form-control"></div>
                    </div>
                    <button class="btn btn-primary w-100">Kaydet</button>
                </form>
            </div>
        </div>

        <div id="tab-stok" class="tab-section">
            <div class="d-flex justify-content-end mb-2">
                <button class="btn btn-warning text-white" onclick="filtrele()">Kritik Olanlar</button>
            </div>
            <div class="custom-card">
                <div style="height:250px; margin-bottom:20px"><canvas id="stokGrafigi"></canvas></div>
                <table class="table table-hover">
                    <thead class="table-light">
                        <tr>
                            <th>Model</th>
                            <th>Stok</th>
                            <th>Durum</th>
                        </tr>
                    </thead>
                    <tbody id="stok-listesi-body"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="/js/yonetici.js"></script>
</body>
</html>
